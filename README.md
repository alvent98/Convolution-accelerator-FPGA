# Convolution-accelerator-FPGA
Convolution Accelerator Implementation (at FPGA using  HLS) for postgraduate Edge Computing Course, Spring Semester 2022

# Assignment Description (in greek):
## Θέμα 1: Υλοποίηση Convolution acceletator σε FPGA μέσω High Level Synthesis
Η συνέλιξη (convolution) είναι μια σημαντική λειτουργία στην επεξεργασία σήματος και εικόνας καθώς
και σε εφαρμογές μηχανικής και βαθιάς μηχανικής μάθησης. Η συνέλιξη λειτουργεί σε δύο σήματα (είτε
1D σήματα είτε σε 2D π.χ. εικόνες). Στην περίπτωση της 2D συνέλιξης, μπορείτε να θεωρήσετε το ένα
ως την εικόνα "εισόδου" και το άλλο (που ονομάζεται πυρήνας) ως "φίλτρο" στην εικόνα εισόδου. Η
λειτουργία της συνέλιξης παράγει μια εικόνα εξόδου, η οποία έχει μετασχηματιστεί σύμφωνα με τη
λειτουργία που προδιαγράφεται στον πίνακα του πυρήνα/φίλτρου.
Έστω:
- 𝐺(c, u, 𝑣) o πίνακας του πυρήνα, όπου c: αριθμός καναλιών του πίνακα πυρήνα, u: ύψος του
πίνακα πυρήνα 𝐺 και 𝑣: πλάτος του πίνακα πυρήνα 𝐺.
- D(c, x, y) o πίνακας της εικόνας εισόδου, όπου c : αριθμός καναλιών του πίνακα εισόδου D, x:
ύψος του πίνακα D και y: το πλάτος του πίνακα D.
    
Η συνέλιξη μεταξύ του πίνακα της εικόνας εισόδου D(c, x, y) και του πίνακα του πυρήνα 𝐺(c, u, 𝑣 )
εκτελείται μέσω της λειτουργίας dot-product, η οποία μπορεί να περιγραφεί ως εξής: 
- Ο πυρήνας 𝐺(c, u, 𝑣) εφαρμόζεται πάνω στον πίνακα εισόδου
D(c, x, y).
- Τα στοιχεία στην αντίστοιχη θέση του πίνακα εισόδου D(c, x, y) και του πυρήνα 𝐺(c, u, 𝑣)
πολλαπλασιάζονται και τα γινόμενα τους αθροίζονται ως μία έξοδος (ένα dot-product).
- Ο πίνακας του πυρήνα ολισθαίνει στον πίνακα εισόδου κατά μία θέση και επαναλαμβάνει τη λειτουργία του dot-product,
δηλ. κάθε βήμα υπολογίζει μια θέση του πίνακα εξόδου Y με μέγεθος (𝑐, 𝑥 - 𝑢 + 1, 𝑦 - 𝑣 + 1).
     
Έστω ότι έχετε στη διάθεση σας ένα FPGA τύπου Xilinx Zynq-7000 με τα εξής χαρακτηριστικά {#LUT:
14400, #FF: 28800, #DSP: 66, #BRAM: 50} με speed grade -3. 
## Ζητούμενα:
1. Να υλοποιηθεί μέσω HLS ένας επιταχυντής υλικού για τη λειτουργία της συνέλιξης και να
προσομοιωθεί η λειτουργία του σε επίπεδο RTL. Να θεωρήσετε εικόνα εισόδου 128x128 pixel (έστω το
κάθε pixel αποτελείται από 8-bit) με 1 κανάλι εισόδου, π.χ greyscale εικόνα.
2. Να προχωρήσετε σε σύνθεση τον επιταχυντή και να καταγράψετε την κατανάλωση των υπολογιστικών
πόρων υλικού του FPGA για την περίπτωση που εφαρμόζονται πυρήνες διαφορετικού μεγέθους, 2x2, 4x4
και 8x8. Να θεωρήσετε πυρήνες εξομάλυνσης, για τα στοιχεία των οποίων ισχύει η ακόλουθη σχέση: 𝐺(u,
𝑣) = 1 / N x M, όπου N και Μ οι διαστάσεις του εκάστοτε πίνακα.
3. Να εξάγετε και να προτείνετε κατάλληλες “στρατηγικές” χρήσης HLS directives (θεωρήστε
κατ’ελάχιστο συνδυασμούς με memory και loop HLS directives), οι οποίες θα παράγουν μια
βελτιστοποιημένη υλοποίηση σε ότι αφορά τον χρόνο εκτέλεσης για κάθε έναν από τους επιταχυντές
υλικού του ερωτήματος 2, με διαφορετικό μέγεθος πυρήνα. Να εξηγήσετε και αξιολογήσετε τα κέρδη της
βελτιστοποίησης.
4. Να επαναλάβετε τη μελέτη του ερωτήματος 2 για δυο διαφορετικές συσκευές FPGA της επιλογής σας,
μια με περισσότερα και μια με λιγότερα resources.
    
## Παραδοτέα:
1. Τεχνική αναφορά – [Περιγραφή – Ανάλυση – Συμπεράσματα]
2. Annotated C/C++ κώδικας ή/και Tcl scripts
3. Dataset αξιολόγησης
4. Demo για την ημέρα της εξέτασης
